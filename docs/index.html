<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Kalman Filter Demo on Bike Image</title>
<link rel="stylesheet" type="text/css" href="./style.css">

<!-- Add a header section with the demo title and description -->
<header>
	<h1>Kalman Filter Demo</h1>
	<p>This demo shows how a Kalman filter can be used to estimate the position of a moving object over time, even in the presence of noise and uncertainty.</p>
</header>

<!-- Use CSS Grid to create a flexible layout -->
<style>
  body {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    grid-gap: 1rem;
  }
  .img, .controls {
    width: 100%;
    margin: auto;
  }
  h1, p {
    text-align: center;
  }
  img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 0 auto;
  }
  .top-right {
    position: absolute;
    top: 0;
    right: 0;
    margin: 1rem;
    z-index: 1;
    font-size: 0.8rem;
  }
  .top-right h4 {
    margin: 0;
    font-weight: normal;
  }
  .controls {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    background-color: #f2f2f2;
  }
  .controls input[type="button"] {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    margin: 0.5rem;
    cursor: pointer;
    border-radius: 4px;
    transition: background-color 0.3s ease;
  }
  .controls input[type="button"]:hover {
    background-color: #3e8e41;
  }
  .controls label {
    font-size: 0.8rem;
    margin-left: 0.5rem;
  }
  #status {
    text-align:center;
    font-size: 0.8rem;
    margin-top: 1rem;
  }
</style>

</head>
<body>
    <div class="img" id='bikes'>
        <img src="./bike.gif">
				<div class="top-right" id='legend'>
					<h4 style="color: blue;">Prediction</h4>
					<h4 style="color: white;">Observation</h4>
					<h4 style="color: red;">Correction</h4>
				</div>
    </div>
    <div class="controls" id='controls'>
  	  <input id="clickMe" type="button" value="Run Kalman Filter" onclick="run();" />
  		<input type="button" value="Stop" >
  		<input id="clickMe" type="button" value="Show/Hide Predictions" onclick="showHide('predicted');" />
  		<input id="clickMe" type="button" value="Show/Hide Observations" onclick="showHide('observation');" />
  		<input id="clickMe" type="button" value="Show/Hide Corrections" onclick="showHide('corrected');" />

  		<input type="checkbox"  id="speedVectors" onclick="showHide('speedVectors');">
		  <label for="checkbox1">Speed Vectors</label>
  		<input type="checkbox"  id="Variances" onclick="showHide('variances');" checked="checked">
  	  <label for="checkbox2">Variances</label>
  		<input type="checkbox"  id="Covariances" onclick="showHide('covariances');">
  	  <label for="checkbox3">Covariances</label>
    </div>

    <!-- Add a div to display status messages -->
    <div id="status"></div>
</body>
<script src="dist/kalman-filter.js"></script>
<script src="dist/bike.js"></script>

<script>
const status = {
  'predicted': false,
  'observation': true,
  'corrected': true,
  'speedVectors': false,
  'variances': true,
  'covariances': false
};
const removeClass = function(el, className) {
  el.classList.remove(className);
};
const addClass = function(el, className) {
  el.classList.add(className);
};
const showHide = function(id) {
  const toRemove = status[id] ? id : 'not-'+id;
  const toAdd = !(status[id]) ? id : 'not-'+id;

	removeClass(document.getElementById("bikes"), toRemove);
  addClass(document.getElementById("bikes"), toAdd);
  status[id] = !(status[id])
}
Object.keys(status).forEach(k => {
  showHide(k)
  showHide(k)
})

const run = function(){
  require('bike').run()
}

// Add event listener to display status messages when the user clicks the "Run Kalman Filter" button
document.querySelector('#clickMe').addEventListener('click', function() {
  document.querySelector('#status').innerHTML = 'Running Kalman Filter...';
});
</script>


</html>